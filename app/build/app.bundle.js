(()=>{"use strict";function t(t){return function(e,n){let a=null;Object.defineProperty(e,n,{get:function(){return a||(console.log(`getting ${t}`),a=document.querySelector(t)),a}})}}class e{_value;_date;_quantity;constructor(t,e,n){this._value=t,this._date=e,this._quantity=n}static createNegotiation(t,n,a){const o=new Date(t.replace(/-/g,",")),i=parseFloat(n),r=parseInt(a);return new e(i,o,r)}toString(){return`\n      Date: ${this.date}\n      Value: ${this.value}\n      Quantity: ${this.quantity}\n    `}compare(t){return this.date.getDate()===t.date.getDate()&&this.date.getMonth()===t.date.getMonth()&&this.date.getFullYear()===t.date.getFullYear()}get value(){return this._value}get date(){return new Date(this._date.getTime())}get quantity(){return this._quantity}get volume(){return this._quantity*this._value}}class n{negotiations=[];constructor(t){this.negotiations=t??[]}add(t){this.negotiations.push(t)}getNegotiations(){return this.negotiations}toString(){return JSON.stringify(this.negotiations,null,2)}compare(t){return this.negotiations.every((e=>t.negotiations.includes(e)))}}class a{path;constructor(t){this.path=`http://localhost:8080${t}`}async getNegotiationsData(){const t=await fetch(this.path);if(t.ok){const n=await t.json();if(n)return n.map((t=>new e(t.montante,new Date,t.vezes)));throw Error("Retrieved negotiations data is null")}throw Error("Error retrieving negotiations data")}}var o;!function(t){t[t.SUNDAY=0]="SUNDAY",t[t.MONDAY=1]="MONDAY",t[t.TUESDAY=2]="TUESDAY",t[t.WEDNESDAY=3]="WEDNESDAY",t[t.THURSDAY=4]="THURSDAY",t[t.FRIDAY=5]="FRIDAY",t[t.SATURDAY=6]="SATURDAY"}(o||(o={}));class i{static isWorkDay(t){const e=t.getDay();return e>o.SUNDAY&&e<o.SATURDAY}}class r{element;constructor(t){const e=document.querySelector(t);if(!e)throw new Error(`Selector ${t} is invalid, please verify the element`);this.element=e}get getElement(){return this.element}update(t){const e=this.returnTemplate(t);this.element.innerHTML=e}}class s extends r{mapTableBodyList(t){return t.getNegotiations().map((t=>`<tr>\n                <th>${t.date.toLocaleDateString()}</th>\n                <th>${t.quantity}</th>\n                <th>${t.value}</th>\n            </tr>`)).join("")}returnTemplate(t){return`\n            <table class="table table-hover table-bordered">\n                <thead>\n                    <tr>\n                        <th>DATA</th>\n                        <th>QUANTIDADE</th>\n                        <th>VALOR</th>\n                    </tr>\n                </thead>\n\n                <tbody>\n                    ${this.mapTableBodyList(t)}\n                </tbody>\n            </table>\n        `}}!function(t,e,n,a){var o,i=arguments.length,r=i<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,a);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(i<3?o(r):i>3?o(e,n,r):o(e,n))||r);i>3&&r&&Object.defineProperty(e,n,r)}([function(t,e,n){const a=n.value;return n.value=function(...t){const e=a.apply(this,t);return"string"==typeof e?e.replace(/<script>[\s\S]*?<\/script>/,""):e},n}],s.prototype,"returnTemplate",null);class u extends r{returnTemplate(t){return`<p class="alert alert-info"> ${t} </p>`}}var l=function(t,e,n,a){var o,i=arguments.length,r=i<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,a);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(i<3?o(r):i>3?o(e,n,r):o(e,n))||r);return i>3&&r&&Object.defineProperty(e,n,r),r};const c=Object.freeze({DATE:"#data",QUANTITY:"#quantidade",VALUE:"#valor"});class d{dateInput;quantityInput;valueInput;negotiationsHandler=new n;negotiationView=new s("#negotiationsView");toastMessageView=new u("#toastMessageView");negotiationsDataService=new a("/dados");constructor(){this.negotiationView.update(this.negotiationsHandler)}add(){const t=e.createNegotiation(this.dateInput.value,this.valueInput.value,this.quantityInput.value);i.isWorkDay(t.date)?(this.negotiationsHandler.add(t),this.updateViews(),this.cleanForm()):this.toastMessageView.update("A data informada deve ser um dia útil!")}async importNegotiationsData(){(await this.negotiationsDataService.getNegotiationsData()).filter((t=>!this.negotiationsHandler.getNegotiations().some((e=>e.compare(t))))).forEach((t=>{this.negotiationsHandler.add(t)})),this.updateViews()}cleanForm(){this.dateInput.value="",this.valueInput.value="",this.quantityInput.value="",this.dateInput.focus()}updateViews(){this.negotiationView.update(this.negotiationsHandler),this.toastMessageView.update("Negociação criada e incluida com sucesso!")}}l([t(c.DATE)],d.prototype,"dateInput",void 0),l([t(c.QUANTITY)],d.prototype,"quantityInput",void 0),l([t(c.VALUE)],d.prototype,"valueInput",void 0),l([function(t,e,n){const a=n.value;return n.value=function(...t){console.log(`=== Function: ${e} ===`),console.log(`-> Params: ${JSON.stringify(t)}`);const n=a.apply(this,t);return console.log(`-> Return: ${JSON.stringify(n)}`),n},n},function(t=!1){return function(e,n,a){const o=a.value;return a.value=function(...e){const a=performance.now(),i=o.apply(this,e),r=performance.now(),s=`${n} | execution time: ${(a-r)/(t?1e3:1)} ${t?"seconds":"ms"}`;return console.log(s),i},a}}()],d.prototype,"add",null);const h=new d,p=document.querySelector(".form"),g=document.querySelector("#import-button");p?.addEventListener("submit",(t=>{t.preventDefault(),h.add()})),g?.addEventListener("click",(t=>{t.preventDefault(),h.importNegotiationsData()}))})();